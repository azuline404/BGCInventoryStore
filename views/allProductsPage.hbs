<form id = "filters" action="/filter" method = "get">
    <select name="category" id="list" onchange="getSelectValue();">
        <option value = "all">Select by Category</option>
        <option value = "all" value="">Show all</option>
        <option value = "shirts" value="Shirts">Shirts</option>
        <option value = "backpacks" value="Backpack">Backpacks</option>
        <option value = "bottles" value="Bottles">Bottles</option>
    </select>
</form>

{{!-- The shopping page item --}}
<br>
<table border = "0" width = "100%" height = "46%">
    <tr style="display: block;" class = "all bottles">
        <td colspan = "5" ><h2 style = "margin:20px 0 0 50px; font-size:50px;">Bottles</h2><hr></td>
    </tr>
    {{#grouped_each 4 bottles}}
    <tr style="display: block;" class = "all bottles">
            {{#each this}}
        <th>
            <div class = "product">
                <div class="showAllProduct" style="display: block;" class = "all bottles">
                    <img src="/uploads/{{product_img}}" class="mainImage mainImage1" style="opacity:1;">
                    <img src="image/bottle.jpg" class="mainImage mainImage1" style="opacity:0;">
                    <img src="image/clothing.jpg" class="mainImage mainImage1" style="opacity:0;">
                    <img src="image/all.jpg" class="mainImage mainImage1" style="opacity:0;">
                    
                    <div class = "pop_window">
                         <div class = "pop_part">
                             <img class = "close" src="image/close.png">
                             <div class = "product-img">
                                <img src="/uploads/{{product_img}}" alt="">
                            </div>
                        <div class = "info">
                            <h2>{{product_name}}<br> <br><span>{{category}}</span></h2>
                             <p>{{product_desc}}</p>
                            {{!-- <a href="/after_add/{{product_id}}/{{sku_id}}" class = "add-cart-btn">Add to Cart</a> --}}
                        </div>
                    </div>
                </div>
                <br>
                <div class="show-left" onclick="left_click(1)">&lt;</div>
                    <img src="image/backpack.jpg" class="subImage subImage1" style="margin-left: 30px;">
                    <img src="image/bottle.jpg" class="subImage subImage1">
                    <img src="image/clothing.jpg" class="subImage subImage1">

                <div class="show-right" onclick="right_click(1)">&gt;</div>
                    <h4 style="text-align:center">{{product_name}}</h4>
                    <p style="text-align:center">{{product_desc}}</p>
                    <a class="view-btn" href="/detail/{{product_id}}">View Detail</a>
                </div>
        </th>
                {{/each}}
        </tr>
        {{/grouped_each}}

    <tr style="display: block;" class = "all backpacks">
        <td colspan = "5"><h2 style = "margin:20px 0 0 50px; font-size:50px;">Backpacks</h2><hr></td>
    </tr>
    {{#grouped_each 4 backpacks}}
    <tr style="display: block;"class="all backpacks">
            {{#each this}}
        <th>
            <div class="product">
                <div class="showAllProduct" style="display: block;" class = "all backpacks">
                    <img src="/uploads/{{product_img}}" class="mainImage mainImage1" style="opacity:1;">
                    <img src="image/bottle.jpg" class="mainImage mainImage1" style="opacity:0;">
                    <img src="image/clothing.jpg" class="mainImage mainImage1" style="opacity:0;">
                    <img src="image/all.jpg" class="mainImage mainImage1" style="opacity:0;">
                    
                    <div class = "pop_window">
                         <div class = "pop_part">
                             <img class = "close" src="image/close.png">
                             <div class = "product-img">
                                <img src="/uploads/{{product_img}}" alt="">
                            </div>
                        <div class = "info">
                            <h2>{{product_name}}<br> <br><span>{{category}}</span></h2>
                             <p>{{product_desc}}</p>
                            <a href="/after_add/{{product_id}}/{{sku_id}}" class="add-cart-btn">Add to Cart</a>
                        </div>
                    </div>
                </div>
                <br>
                <div class="show-left" onclick="left_click(1)">&lt;</div>
                    <img src="image/backpack.jpg" class="subImage subImage1" style="margin-left: 30px;">
                    <img src="image/bottle.jpg" class="subImage subImage1">
                    <img src="image/clothing.jpg" class="subImage subImage1">

                <div class="show-right" onclick="right_click(1)">&gt;</div>
                    <h4 style="text-align:center">{{product_name}}</h4>
                    <p style="text-align:center">{{product_desc}}</p>
                    <a class="view-btn" href="/detail/{{product_id}}">View Detail</a>
                </div> 
        </th>
                {{/each}}
        </tr>
        {{/grouped_each}}

    <tr style="display: block;" class = "all shirts">
        <td colspan = "5"><h2 style = "margin:20px 0 0 50px; font-size:50px;">Shirts</h2><hr></td>
    </tr>
    {{#grouped_each 4 shirts}}
    <tr style="display: block;"  class = "all shirts">
            {{#each this }}
        <th>
            <div class = "product" >
                <div class="showAllProduct" style="display: block;"  class = "all shirts">
                    <img src="/uploads/{{product_img}}" class="mainImage mainImage1" style="opacity:1;">
                    <img src="image/bottle.jpg" class="mainImage mainImage1" style="opacity:0;">
                    <img src="image/clothing.jpg" class="mainImage mainImage1" style="opacity:0;">
                    <img src="image/all.jpg" class="mainImage mainImage1" style="opacity:0;">
                    
                    <div class = "pop_window">
                         <div class = "pop_part">
                             <img class = "close" src="image/close.png">
                             <div class = "product-img">
                                <img src="/uploads/{{product_img}}" alt="">
                            </div>
                        <div class = "info">
                            <h2>{{product_name}}<br> <br><span>{{category}}</span></h2>
                             <p>{{product_desc}}</p>
                            <a href="/after_add/{{product_id}}/{{sku_id}}" class = "add-cart-btn">Add to Cart</a>
                        </div>
                    </div>
                </div>
                <br>
                <div class="show-left" onclick="left_click(1)">&lt;</div>
                    <img src="image/backpack.jpg" class="subImage subImage1" style="margin-left: 30px;">
                    <img src="image/bottle.jpg" class="subImage subImage1">
                    <img src="image/clothing.jpg" class="subImage subImage1">

                <div class="show-right" onclick="right_click(1)">&gt;</div>
                    <h4 style="text-align:center">{{product_name}}</h4>
                    <p style="text-align:center">{{product_desc}}</p>
                    <a class="view-btn" href="/detail/{{product_id}}">View Detail</a>
                </div> 
        </th>
                {{/each}}
        </tr>
        {{/grouped_each}}
</table>

<script type = "text/javascript">
var popupViews = document.querySelectorAll('.pop_window');
var popupBtns = document.querySelectorAll('.pop_button');
var closeBtns = document.querySelectorAll('.close');
var popup = function(popupClick){
    popupViews[popupClick].classList.add('active')
}
popupBtns.forEach((popupBtn , i)=> {
    popupBtn.addEventListener("click", () => {
        popup(i);
    });
});
closeBtns.forEach((closeBtn)=> {
    closeBtn.addEventListener("click", () => {
        popupViews.forEach((popupViews) => {
            popupViews.classList.remove('active');
        });
    });
});
const allCategoryPosts = document.querySelectorAll('.all');
function getSelectValue(){
    var selectedValue = document.getElementById("list").value;
    console.log("here " + selectedValue)
    if (selectedValue == "all"){
        for (let j = 0; j < allCategoryPosts.length; j++){
            allCategoryPosts[j].style.display = "block"
        }
    }
    else{
        for(let k = 0; k < allCategoryPosts.length; k++){
            if(allCategoryPosts[k].classList.contains(selectedValue)){
                allCategoryPosts[k].style.display = "block";
                } 
            else {
                allCategoryPosts[k].style.display = "none";
                }
        }
    }
}
</script>